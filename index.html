<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Video Editing Queue</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h1 { text-align: center; }
    form { max-width: 600px; margin: 0 auto 40px auto; padding: 20px; border: 1px solid #ccc; border-radius: 8px; background-color: #f9f9f9; }
    label { display: block; margin-bottom: 5px; font-weight: bold; }
    input, textarea, select { width: 100%; padding: 8px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 4px; }
    button { padding: 10px 20px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
    button:hover { background-color: #0056b3; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #f4f4f4; }
    tr:nth-child(even) { background-color: #fafafa; }
    .status-pending { color: orange; font-weight: bold; }
    .status-inprogress { color: blue; font-weight: bold; }
    .status-done { color: green; font-weight: bold; }
  </style>
</head>
<body>
  <h1>Video Editing Queue</h1>

  <form id="request-form">
    <label for="requester">Requester</label>
    <input type="text" id="requester" name="Requester" required>

    <label for="description">Job Description</label>
    <textarea id="description" name="Job Description" required></textarea>

    <label for="receivedDate">Job Received Date</label>
    <input type="date" id="receivedDate" name="Job Received Date" required>

    <label for="remarks">Remarks</label>
    <textarea id="remarks" name="Remarks"></textarea>

    <label for="status">Status</label>
    <select id="status" name="Status" required>
      <option value="Pending">Pending</option>
      <option value="In Progress">In Progress</option>
      <option value="Done">Done</option>
    </select>

    <button type="submit">Submit Request</button>
  </form>

  <table id="queue-table">
    <thead>
      <tr>
        <th>Requester</th>
        <th>Job Description</th>
        <th>Job Received Date</th>
        <th>Remarks</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      <!-- Rows will be populated here -->
    </tbody>
  </table>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbxeYMXkkawHPugL8CpiEYHGns6c_gIaIncsF2iVAJU23ux3iRdUs221BQCloUd9zJFftQ/exec';

    // Load existing data
    fetch(scriptURL)
      .then(response => response.json())
      .then(data => {
        const tbody = document.querySelector('#queue-table tbody');
        data.forEach(row => {
          const tr = document.createElement('tr');
          const fields = ['Requester', 'Job Description', 'Job Received Date', 'Remarks', 'Status'];
          fields.forEach(field => {
            const td = document.createElement('td');
            if (field === 'Status') {
              const status = (row[field] || '').toLowerCase();
              td.className = 'status-' + status.replace(/\s+/g, '');
            }
            td.textContent = row[field] || '';
            tr.appendChild(td);
          });
          tbody.appendChild(tr);
        });
      })
      .catch(error => {
        console.error('Error fetching data:', error);
      });

    // Handle form submission
    document.getElementById('request-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData(form);
      fetch(scriptURL, { method: 'POST', body: formData })
        .then(response => {
          alert('Request submitted successfully!');
          form.reset();
          location.reload();
        })
        .catch(error => {
          console.error('Error submitting request:', error);
          alert('There was an error submitting your request.');
        });
    });
  </script>
</body>
</html>
