<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>üìπ ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏¥‡∏ß‡∏ï‡∏±‡∏î‡∏ï‡πà‡∏≠‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-sm">

  <div class="max-w-4xl mx-auto p-6">
    <div class="bg-white p-6 rounded-2xl shadow-xl">
      <h1 class="text-3xl font-bold text-center mb-6 text-blue-700">üìπ ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏¥‡∏ß‡∏ï‡∏±‡∏î‡∏ï‡πà‡∏≠‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠</h1>

      <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏° -->
      <form id="jobForm" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
        <input id="requester" placeholder="‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á‡∏á‡∏≤‡∏ô" required class="border p-2 rounded" />
        <input id="jobDesc" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô" required class="border p-2 rounded" />
        <input type="date" id="jobDate" required class="border p-2 rounded" />
        <input id="remarks" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏" class="border p-2 rounded" />
        <div class="md:col-span-2 text-right">
          <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded shadow">
            ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏¥‡∏ß‡∏á‡∏≤‡∏ô
          </button>
        </div>
      </form>

      <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏á‡∏≤‡∏ô -->
      <div class="overflow-x-auto">
        <table class="table-auto w-full border text-center bg-white shadow rounded">
          <thead class="bg-gray-200">
            <tr>
              <th class="p-2">‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á</th>
              <th class="p-2">‡∏á‡∏≤‡∏ô</th>
              <th class="p-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô</th>
              <th class="p-2">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
            </tr>
          </thead>
          <tbody id="jobTable" class="bg-white"></tbody>
        </table>
      </div>
    </div>
  </div>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbx0Ll2-JkmXrUyg-9b_fXCf08mJzbUltIrdf7nMhpEE/dev";
    const jobForm = document.getElementById("jobForm");
    const jobTable = document.getElementById("jobTable");

    jobForm.addEventListener("submit", async (e) => {
      e.preventDefault();

      const job = {
        requester: document.getElementById("requester").value.trim(),
        jobDesc: document.getElementById("jobDesc").value.trim(),
        jobDate: document.getElementById("jobDate").value,
        remarks: document.getElementById("remarks").value.trim(),
      };

      try {
        const res = await fetch(API_URL, {
          method: "POST",
          body: JSON.stringify(job),
          headers: { "Content-Type": "application/json" }
        });
        const result = await res.json();
        alert("‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏¥‡∏ß‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!");
        jobForm.reset();
        loadJobs();
      } catch (err) {
        alert("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + err.message);
      }
    });

    async function loadJobs() {
      try {
        const res = await fetch(API_URL);
        const jobs = await res.json();
        jobTable.innerHTML = "";
        jobs.forEach(job => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td class="border p-2">${job.requester || ""}</td>
            <td class="border p-2">${job.jobDesc || ""}</td>
            <td class="border p-2">${job.jobDate || ""}</td>
            <td class="border p-2">${job.remarks || ""}</td>
          `;
          jobTable.appendChild(row);
        });
      } catch (err) {
        jobTable.innerHTML = `<tr><td colspan="4" class="p-4 text-red-500">‚ö†Ô∏è ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</td></tr>`;
      }
    }

    loadJobs();
  </script>

</body>
</html>
